{"version":3,"sources":["app.js","config.js","filter.js","router.js","modules/good.js","modules/guide.js","modules/tab-home.js","modules/tabs.js"],"names":["angular","module","run","$ionicPlatform","ready","setTimeout","navigator","splashscreen","hide","window","cordova","plugins","Keyboard","hideKeyboardAccessoryBar","disableScroll","StatusBar","styleLightContent","backgroundColorByHexString","config","$ionicConfigProvider","platform","ios","tabs","style","position","android","navBar","alignTitle","views","transition","backButton","previousTitleText","text","Config","_ref","_ref$host","host","undefined","_ref$port","port","_ref$ssl","ssl","_ref$activityPoster","activityPoster","_classCallCheck","this","protocol","serverUrl","filter","imageUrl","replace","avatarUrl","reg","test","str","$stateProvider","$urlRouterProvider","state","url","templateUrl","controller","abstract","tab-home","tab-chats","tab-account","otherwise","localStorage","$scope","$rootScope","$stateParams","console","log","transparentBar","$state","$timeout","index","slideStatus","delay","changeBC","$index","go","out","$ionicSlideBoxDelegate","$cordovaToast","$http","HomeTab","defaultIndex","arguments","length","activeItem","_createClass","key","value","slide","homeTab","RefreshComponent","_ref$path","path","_ref$current","current","_ref$offset","offset","_ref$showInfinite","showInfinite","loadData","data","items","_this","$broadcast","_this2","good","_this3","method","params","then","resData","code","concat","showShortCenter","catch","banner","image","goDetail","id","service","$ionicTabsDelegate","viewName","$on","e","stateName","flag","showBar"],"mappings":"qOAMAA,QAAQC,OAAO,WAAY,QAAQ,YAAa,WAAY,sBAAuB,qBAClFC,KAAK,iBAAkB,SAAUC,GAC9BA,EAAeC,MAAM,WAEjBC,WAAW,WAEPC,UAAUC,cAAgBD,UAAUC,aAAaC,QAClD,MAGCC,OAAOC,SAAWD,OAAOC,QAAQC,SAAWF,OAAOC,QAAQC,QAAQC,WACnEF,QAAQC,QAAQC,SAASC,0BAAyB,GAClDH,QAAQC,QAAQC,SAASE,eAAc,IAEvCL,OAAOM,YAEPA,UAAUC,oBACVD,UAAUE,2BAA2B,iBAG7CC,QAAQ,uBACR,SAACC,GAEGA,EAAqBC,SAASC,IAAIC,KAAKC,MAAM,YAC7CJ,EAAqBC,SAASC,IAAIC,KAAKE,SAAS,UAChDL,EAAqBC,SAASK,QAAQH,KAAKC,MAAM,YACjDJ,EAAqBC,SAASK,QAAQH,KAAKE,SAAS,UAEpDL,EAAqBC,SAASC,IAAIK,OAAOC,WAAW,UACpDR,EAAqBC,SAASK,QAAQC,OAAOC,WAAW,QAOxDR,EAAqBC,SAASC,IAAIO,MAAMC,WAAW,OACnDV,EAAqBC,SAASK,QAAQG,MAAMC,WAAW,WACvDV,EAAqBW,WAAWC,mBAAkB,GAClDZ,EAAqBW,WAAWE,KAAK,WC3BvCC,QACF,QAAAA,GAAAC,GAKG,GAAAC,GAAAD,EAJCE,KAAAA,MAIDC,KAAAF,EAJQ,YAIRA,EAAAG,EAAAJ,EAHCK,KAAAA,MAGDF,KAAAC,EAHQ,OAGRA,EAAAE,EAAAN,EAFCO,IAAAA,MAEDJ,KAAAG,GAAAA,EAAAE,EAAAR,EADCS,eAAAA,MACDN,KAAAK,EADkB,mBAClBA,CAAAE,iBAAAC,KAAAZ,GACCY,KAAKT,KAAOA,EACZS,KAAKN,KAAOA,EACZM,KAAKC,SAAWL,EAAM,QAAU,OAChCI,KAAKE,UAAeF,KAAKC,SAAzB,MAAuCD,KAAKT,KAA5C,IAAoDS,KAAKN,KACzDM,KAAKF,eAAiBA,GAGxBA,eAAAA,qEAEAzB,OAAS,GAAIe,SACfU,eAAAA,gBC3BJ3C,SAAQC,OAAO,WAAW+C,OAAO,YAAY,WAEzC,MAAO,UAACC,GACJ,MAAOA,GAASC,QAAQ,OAAO,WAEpCF,OAAO,SAAS,WAEf,MAAO,UAACG,GACJ,GAAIC,GAAM,YAKV,OAHID,IAAcC,EAAIC,KAAKF,KACvBA,EAAY,sDAETA,KAEZH,OAAO,UAAU,WAEhB,MAAO,UAACM,GAEJ,MAAA,OAAcA,EAAIJ,QAAQ,OAAO,OAAjC,UClBRlD,QAAQC,OAAO,YAAa,UAAUiB,QAAQ,iBAAkB,qBAC5D,SAACqC,EAAgBC,GACbD,EAAeE,MAAM,SACjBC,IAAK,SACLC,YAAa,yBACbC,WAAY,oBACbH,MAAM,OACLC,IAAK,OACLG,UAAU,EACVF,YAAa,kBACbC,WAAW,mBACZH,MAAM,YACLC,IAAK,QACL9B,OACIkC,YACIH,YAAa,2BACbC,WAAY,qBAGrBH,MAAM,mBACLC,IAAK,kBACL9B,OACIkC,YACIH,YAAa,yBACbC,WAAY,2BAGrBH,MAAM,aACLC,IAAK,SACL9B,OACImC,aACIJ,YAAa,uBACbC,WAAY,gBAGrBH,MAAM,mBACLC,IAAK,iBACL9B,OACImC,aACIJ,YAAa,yBACbC,WAAY,qBAGrBH,MAAM,eACLC,IAAK,WACL9B,OACIoC,eACIL,YAAa,yBACbC,WAAY,kBAKxBJ,EAAmBS,UAAUC,aAAA,OAAyB,YAAc,aCvD5ElE,QAAQC,OAAO,WAAW2D,WAAW,wBAAyB,SAAU,aAAc,eAClF,SAACO,EAAQC,EAAYC,GAEjBC,QAAQC,IAAIJ,GACZC,EAAWI,gBAAiB,KCHpCxE,QAAQC,OAAO,WAAW2D,WAAW,mBAAoB,SAAU,iBAAkB,SAAU,WAC3F,SAACO,EAAQhE,EAAgBsE,EAAQC,GAC7BP,EAAOQ,MAAQ,EACfR,EAAOS,cAAe,GAAM,GAAO,GACnCT,EAAOU,OAAQ,EACfV,EAAOW,SAAW,SAACC,GACfZ,EAAOQ,MAAQI,EACfZ,EAAOU,OAAQ,EACfV,EAAOS,YAAYG,IAAU,GAEjCZ,EAAOa,GAAK,WAERb,EAAOc,KAAM,EACbP,EAAS,WACFD,EAAOO,GAAG,aACd,4QChBfhF,SAAQC,OAAO,WAAW2D,WAAW,kBAAmB,SAAU,yBAA0B,gBAAiB,QAAS,SAClH,SAACO,EAAQe,EAAwBC,EAAeC,EAAOX,GAAW,GAExDY,GAFwD,WAG1D,QAAAA,KAA8B,GAAlBC,GAAkBC,UAAAC,OAAA,OAAAnD,KAAAkD,UAAA,GAAAA,UAAA,GAAH,CAAG3C,iBAAAC,KAAAwC,GAC1BxC,KAAK4C,WAAaH,EAJoC,MAAAI,cAAAL,IAAAM,IAAA,YAAAC,MAAA,SAMhDjB,GAEN9B,KAAK4C,WAAad,EAClBO,EAAuBW,MAAMhD,KAAK4C,gBAToBJ,IAY9DlB,GAAO2B,QAAU,GAAIT,GAAQ,EAZiC,IAkBxDU,GAlBwD,WA8B1D,QAAAA,GAAA7D,GAMG,GAAA8D,GAAA9D,EALC+D,KAAAA,MAKD5D,KAAA2D,EALQ,WAKRA,EAAAE,EAAAhE,EAJCiE,QAAAA,MAID9D,KAAA6D,EAJW,EAIXA,EAAAE,EAAAlE,EAHCmE,OAAAA,MAGDhE,KAAA+D,EAHU,GAGVA,EAAAE,EAAApE,EAFCqE,aAAAA,MAEDlE,KAAAiE,GAAAA,EADCE,EACDtE,EADCsE,QACD5D,iBAAAC,KAAAkD,GACClD,KAAKoD,KAAOA,EACZpD,KAAKsD,QAAUA,EACftD,KAAKwD,OAASA,EACdxD,KAAK0D,aAAeA,EACpB1D,KAAK2D,SAAWA,EAChB3D,KAAK4D,MACDC,UA3CkD,MAAAhB,cAAAK,IAAAJ,IAAA,UAAAC,MAAA,WA+ChD,GAAAe,GAAA9D,IAENA,MAAK0D,cAAe,EAEpB1D,KAAKsD,QAAU,EACftD,KAAK4D,KAAKC,SACVrG,WAAW,WACPsG,EAAKH,WACLrC,EAAOyC,WAAW,2BACnB,QAxDmDjB,IAAA,WAAAC,MAAA,WA2D/C,GAAAiB,GAAAhE,IACPxC,YAAW,WACPwG,EAAKL,YACN,SA9DmDT,IAkE9D5B,GAAO2C,KAAO,GAAIf,IACdE,KAAM,gBACNO,SAAU,WAAY,GAAAO,GAAAlE,IAClBuC,IACI4B,OAAQ,MACRtD,IAAKxC,OAAO6B,UAAYF,KAAKoD,KAC7BgB,QACId,QAAStD,KAAKsD,QACdE,OAAQxD,KAAKwD,UAElBa,KAAK,SAAAC,GACAA,EAAQV,KAAKW,MAAQD,EAAQV,KAAKC,MAAMlB,OAAS,GACjDuB,EAAKN,KAAKC,MAAQK,EAAKN,KAAKC,MAAMW,OAAOF,EAAQV,KAAKC,OACtDK,EAAKZ,SAAWY,EAAKV,QACdc,EAAQV,KAAKW,MAAsC,IAA9BD,EAAQV,KAAKC,MAAMlB,QAC/CuB,EAAKR,cAAe,EACpBpB,EAAcmC,gBAAgB,aAE9BnC,EAAcmC,gBAAgB,kBAElCnD,EAAOyC,WAAW,mCACnBW,MAAM,SAAAJ,GACLhC,EAAcmC,gBAAgB,qBAI1CnD,EAAO2C,KAAKL,KAAKe,QACbC,MAAOvG,OAAOyB,gBAElBwB,EAAO2C,KAAKY,SAAW,SAAAC,GACnBlD,EAAOO,GAAG,mBAInB4C,QAAQ,kBC5GX5H,QAAQC,OAAO,WAAW2D,WAAW,kBAAmB,SAAU,aAAa,qBAC3E,SAACO,EAAQC,EAAWyD,GAChB,GAAIC,OAAAA,EACJ1D,GAAW2D,IAAI,yBAAyB,SAASC,EAAEvB,GAE/CqB,EAAWrB,EAAKwB,SAChB,IAAIC,GAAmB,YAAZJ,GAAsC,YAAZA,CACrCD,GAAmBM,QAAQD,KAE/B9D,EAAW2D,IAAI,yBAAyB,SAASC,EAAEvB","file":"ionic.app.min.js","sourcesContent":["/*\n * @Author: Cphayim \n * @Date: 2017-04-15 19:53:57 \n * @Last Modified by: Cphayim\n * @Last Modified time: 2017-04-24 23:24:37\n */\nangular.module('Chufaba', ['ionic','ngCordova', 'myRouter', 'starter.controllers', 'starter.services'])\n.run(['$ionicPlatform', function ($ionicPlatform) {\n    $ionicPlatform.ready(()=> {\n        // 隐藏启动界面\n        setTimeout(()=> {\n            // 延迟1.5秒防止闪屏\n            navigator.splashscreen && navigator.splashscreen.hide();\n        }, 1500);\n        // Hide the accessory bar by default (remove this to show the accessory bar above the keyboard\n        // for form inputs)\n        if (window.cordova && window.cordova.plugins && window.cordova.plugins.Keyboard) {\n            cordova.plugins.Keyboard.hideKeyboardAccessoryBar(true);\n            cordova.plugins.Keyboard.disableScroll(true);\n        }\n        if (window.StatusBar) {\n            // org.apache.cordova.statusbar required\n            StatusBar.styleLightContent();\n            StatusBar.backgroundColorByHexString('#21272f');\n        }\n    });\n}]).config(['$ionicConfigProvider',\n    ($ionicConfigProvider)=> {\n        // iOS/Android 平台设置\n        $ionicConfigProvider.platform.ios.tabs.style('standard');     /*标准的    striped and standard. */\n        $ionicConfigProvider.platform.ios.tabs.position('bottom');    /*ios 平台tabs的位置*/\n        $ionicConfigProvider.platform.android.tabs.style('standard');\n        $ionicConfigProvider.platform.android.tabs.position('bottom');   /*android 平台tabs的位置*/\n\n        $ionicConfigProvider.platform.ios.navBar.alignTitle('center');    /*标题的位置*/\n        $ionicConfigProvider.platform.android.navBar.alignTitle('left');\n\n        /*返回文字  和图标*/\n        //$ionicConfigProvider.platform.ios.backButton.previousTitleText(' ').icon('ion-ios-arrow-thin-left');\n        //$ionicConfigProvider.platform.android.backButton.previousTitleText(' ').icon('ion-android-arrow-back');\n\n\n        $ionicConfigProvider.platform.ios.views.transition('ios');    /*切换效果*/\n        $ionicConfigProvider.platform.android.views.transition('android');\n        $ionicConfigProvider.backButton.previousTitleText(false);    /*去掉返回  文字*/\n        $ionicConfigProvider.backButton.text(' ');\n    }\n]);","/*\n * 前端全局配置文件\n * @Author: Cphayim \n * @Date: 2017-04-23 19:14:18 \n * @Last Modified by: Cphayim\n * @Last Modified time: 2017-04-24 23:04:46\n */\n\n/**\n * 配置类\n * 用于实例化一个包含全局配置信息的对象\n * @param {Object} {\n *         host = '127.0.0.1', // 主机名，默认本地\n *         port = '3000', // 端口号，默认3000\n *         ssl = false, // 传输协议是否包含安全套接层\n *         activityPoster = '' // 活动海报的 imageUrl\n *     } \n */\nclass Config {\n    constructor({ // 解构赋值\n        host = '127.0.0.1',\n        port = '3000',\n        ssl = false,\n        activityPoster = '/img/default.jpg'\n    }) {\n        this.host = host;\n        this.port = port;\n        this.protocol = ssl ? 'https' : 'http';\n        this.serverUrl = `${this.protocol}://${this.host}:${this.port}`;\n        this.activityPoster = activityPoster;\n    }\n}\nconst activityPoster = `http://img.chufaba.me/events/e3d11e3218c1a9102a0848ff54ad4a17n.jpg`;\n// 开发环境\nconst config = new Config({\n    activityPoster\n});\n// 生产环境\n// const config = new Config({\n//     host: 'cfb.cphayim.me',\n//     port: '3377',\n//     activityPoster\n// });\n// console.log(config);\n","/*\n * 自定义过滤器\n * @Author: Cphayim \n * @Date: 2017-04-24 15:25:00 \n * @Last Modified by: Cphayim\n * @Last Modified time: 2017-04-24 21:19:42\n */\n\nangular.module('Chufaba').filter('imageSize',()=>{\n    // 图片大小处理\n    return (imageUrl)=>{\n        return imageUrl.replace('!320','!375');\n    }\n}).filter('avatar',()=>{\n    // 处理头像地址\n    return (avatarUrl)=>{\n        let reg = /(jpg|png)$/;\n        // 没有头像或头像 url 未通过正则验证，使用默认头像\n        if(!avatarUrl || !reg.test(avatarUrl)){\n            avatarUrl = 'http://cfbassets.b0.upaiyun.com/assets/v2/head.png';\n        }\n        return avatarUrl;\n    }\n}).filter('pointer',()=>{\n    // 处理地点\n    return (str)=>{\n        // 正则替换\n        return `— · ${str.replace(/(、)/g,' · ')} · —`;\n    }\n});","/*\n * 前端路由模块\n * @Author: Cphayim \n * @Date: 2017-04-15 19:52:03 \n * @Last Modified by: Cphayim\n * @Last Modified time: 2017-04-24 22:57:35\n */\n\n'use strict';\nangular.module('myRouter', ['ionic']).config(['$stateProvider', '$urlRouterProvider',\n    ($stateProvider, $urlRouterProvider) => {\n        $stateProvider.state('guide', {\n            url: '/guide',\n            templateUrl: 'views/guide/guide.html',\n            controller: 'guideController'\n        }).state('tab', {\n            url: '/tab',\n            abstract: true,\n            templateUrl: 'views/tabs.html',\n            controller:'TabsController'\n        }).state('tab.home', {\n            url: '/home',\n            views: {\n                'tab-home': {\n                    templateUrl: 'views/tabs/tab-home.html',\n                    controller: 'HomeController'\n                }\n            }\n        }).state('tab.good-detail', {\n            url: '/good-detail:id',\n            views: {\n                'tab-home': {\n                    templateUrl: 'views/detail/good.html',\n                    controller: 'GoodDetailController'\n                }\n            }\n        }).state('tab.chats', {\n            url: '/chats',\n            views: {\n                'tab-chats': {\n                    templateUrl: 'views/tab-chats.html',\n                    controller: 'ChatsCtrl'\n                }\n            }\n        }).state('tab.chat-detail', {\n            url: '/chats/:chatId',\n            views: {\n                'tab-chats': {\n                    templateUrl: 'views/chat-detail.html',\n                    controller: 'ChatDetailCtrl'\n                }\n            }\n        }).state('tab.account', {\n            url: '/account',\n            views: {\n                'tab-account': {\n                    templateUrl: 'views/tab-account.html',\n                    controller: 'AccountCtrl'\n                }\n            }\n        })\n        // if none of the above states are matched, use this as the fallback\n        $urlRouterProvider.otherwise(localStorage['guided'] ? '/tab/home' : '/guide');\n    }\n])\n","/*\n * 精选详情页\n * @Author: Cphayim \n * @Date: 2017-04-24 21:29:47 \n * @Last Modified by: Cphayim\n * @Last Modified time: 2017-04-24 23:35:51\n */\nangular.module('Chufaba').controller('GoodDetailController', ['$scope', '$rootScope', '$stateParams',\n    ($scope, $rootScope, $stateParams) => {\n        // console.log($stateParams);\n        console.log($scope);\n        $rootScope.transparentBar = true;\n    }\n]);\n","/*\n * @Author: Cphayim \n * @Date: 2017-04-15 19:51:57 \n * @Last Modified by: Cphayim\n * @Last Modified time: 2017-04-20 22:58:36\n */\n\n'use strict';\nangular.module('Chufaba').controller('guideController', ['$scope', '$ionicPlatform', '$state', '$timeout',\n    ($scope, $ionicPlatform, $state, $timeout) => {\n        $scope.index = 0;\n        $scope.slideStatus = [true, false, false];\n        $scope.delay = true;\n        $scope.changeBC = ($index) => {\n            $scope.index = $index;\n            $scope.delay = false;\n            $scope.slideStatus[$index] = true;\n        }\n        $scope.go = () => {\n            // $state.go('tab.dash');\n            $scope.out = true;\n            $timeout(() => {\n                   $state.go('tab.home');\n            }, 1000);\n        }\n        // 设置 已首次打开过 的 localStorage\n        // localStorage['guided'] = true;\n    }\n]);\n","/*\n * @Author: Cphayim \n * @Date: 2017-04-18 21:33:38 \n * @Last Modified by: Cphayim\n * @Last Modified time: 2017-04-24 23:12:36\n */\n// Home 界面控制器\nangular.module('Chufaba').controller('HomeController', ['$scope', '$ionicSlideBoxDelegate', '$cordovaToast', '$http', '$state',\n    ($scope, $ionicSlideBoxDelegate, $cordovaToast, $http, $state) => {\n        // HomeTab 类\n        class HomeTab {\n            constructor(defaultIndex = 0) {\n                this.activeItem = defaultIndex;\n            }\n            setActive(index) {\n                // 设置 tab\n                this.activeItem = index;\n                $ionicSlideBoxDelegate.slide(this.activeItem);\n            }\n        }\n        $scope.homeTab = new HomeTab(1); // 绑定homeTab实例到作用域，默认激活第二个 tab\n\n        /**\n         * 刷新(下拉刷新/上拉加载)组件类\n         * @class RefreshComponent\n         */\n        class RefreshComponent {\n            /**\n             * 构造函数参数说明\n             * 传入的对象将被解构赋值\n             * @param {Object} {\n             *        {Sring}    path          http 请求路径，不包括主机名，默认值 '/product'\n             *        {Number}   current       当前列表索引，默认值 0\n             *        {Number}   offset        每次请求加载的数量(列表项数)，默认值 10\n             *        {Boolean}  showInfinite  是否启用上拉加载，默认值 true\n             *        {Function} loadData      http 请求函数，将在 refresh/infinite 中回调\n             *    } \n             */\n            constructor({\n                path = '/product',\n                current = 0,\n                offset = 10,\n                showInfinite = true,\n                loadData\n            }) {\n                this.path = path;\n                this.current = current;\n                this.offset = offset;\n                this.showInfinite = showInfinite;\n                this.loadData = loadData;\n                this.data = { // 数据挂载容器对象，绑定到视图层\n                    items: []\n                }\n            }\n            // 下拉刷新方法\n            refresh() {\n                // 重置上拉加载状态\n                this.showInfinite = true;\n                // 重置数据列表/索引\n                this.current = 0;\n                this.data.items = [];\n                setTimeout(() => {\n                    this.loadData(); // 发送 http 请求\n                    $scope.$broadcast('scroll.refreshComplete');\n                }, 1000);\n            }\n            // 上拉加载方法\n            infinite() {\n                setTimeout(() => {\n                    this.loadData(); // 发送 http 请求\n                }, 500);\n            }\n        }\n        // 实例化刷新组件添加到作用域上\n        $scope.good = new RefreshComponent({\n            path: '/product/good',\n            loadData: function () {\n                $http({\n                    method: 'GET',\n                    url: config.serverUrl + this.path,\n                    params: {\n                        current: this.current,\n                        offset: this.offset\n                    }\n                }).then(resData => {\n                    if (resData.data.code && resData.data.items.length > 0) {\n                        this.data.items = this.data.items.concat(resData.data.items);\n                        this.current += this.offset;\n                    } else if (resData.data.code && resData.data.items.length === 0) {\n                        this.showInfinite = false; // 关闭上拉加载\n                        $cordovaToast.showShortCenter('没有更多数据了!');\n                    } else {\n                        $cordovaToast.showShortCenter('数据请求失败，请尝试下拉刷新');\n                    }\n                    $scope.$broadcast('scroll.infiniteScrollComplete'); // 发送广播:加载完成\n                }).catch(resData => {\n                    $cordovaToast.showShortCenter('数据请求失败，请检查网络');\n                });\n            }\n        });\n        $scope.good.data.banner = {\n            image: config.activityPoster\n        };\n        $scope.good.goDetail = id => {\n            $state.go('good-detail');\n        }\n\n    }\n]).service('HomeService', []);\n","angular.module('Chufaba').controller('TabsController', ['$scope', '$rootScope','$ionicTabsDelegate',\n    ($scope, $rootScope,$ionicTabsDelegate) => {\n        let viewName;\n        $rootScope.$on('$ionicView.beforeEnter',function(e,data){\n            // console.log(data.stateName+'准备进入');\n            viewName = data.stateName;\n            let flag = viewName == 'tab.home' || viewName == 'tab.user';\n            $ionicTabsDelegate.showBar(flag)\n        });\n        $rootScope.$on('$ionicView.beforeLeave',function(e,data){\n            // console.log(data.stateName+'准备离开');\n        });\n\n    }\n]);"]}